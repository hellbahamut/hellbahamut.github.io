import{_ as i,c as a,o as n,a2 as t}from"./chunks/framework.C2eRlmqf.js";const E=JSON.parse('{"title":"模块五：模型评估与调优","description":"评估指标、交叉验证与超参数搜索","frontmatter":{"title":"模块五：模型评估与调优","description":"评估指标、交叉验证与超参数搜索","order":5},"headers":[],"relativePath":"guide/03-ml-basics/05-evaluation.md","filePath":"guide/03-ml-basics/05-evaluation.md","lastUpdated":1768553241000}'),l={name:"guide/03-ml-basics/05-evaluation.md"};function h(e,s,p,r,k,d){return n(),a("div",null,[...s[0]||(s[0]=[t(`<h1 id="模块五-模型评估与调优" tabindex="-1">模块五：模型评估与调优 <a class="header-anchor" href="#模块五-模型评估与调优" aria-label="Permalink to &quot;模块五：模型评估与调优&quot;">​</a></h1><h2 id="_5-1-评估指标" tabindex="-1">5.1 评估指标 <a class="header-anchor" href="#_5-1-评估指标" aria-label="Permalink to &quot;5.1 评估指标&quot;">​</a></h2><h3 id="_5-1-1-分类指标" tabindex="-1">5.1.1 分类指标 <a class="header-anchor" href="#_5-1-1-分类指标" aria-label="Permalink to &quot;5.1.1 分类指标&quot;">​</a></h3><ul><li><strong>准确率 (Accuracy)</strong>: 预测对的比例。类别不平衡时失效。</li><li><strong>精确率 (Precision)</strong>: 预测为正的样本中有多少是真的正样本。 (宁缺毋滥)</li><li><strong>召回率 (Recall)</strong>: 真实正样本中有多少被预测出来了。 (宁可错杀不可放过)</li><li><strong>F1-Score</strong>: 精确率和召回率的调和平均。</li><li><strong>AUC-ROC</strong>: 衡量模型排序能力的指标，对阈值不敏感。</li></ul><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sklearn.metrics </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> classification_report, roc_auc_score</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(classification_report(y_test, y_pred))</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;AUC:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, roc_auc_score(y_test, y_prob))</span></span></code></pre></div><h3 id="_5-1-2-回归指标" tabindex="-1">5.1.2 回归指标 <a class="header-anchor" href="#_5-1-2-回归指标" aria-label="Permalink to &quot;5.1.2 回归指标&quot;">​</a></h3><ul><li><strong>MSE (均方误差)</strong>: 对大误差敏感。</li><li><strong>MAE (平均绝对误差)</strong>: 鲁棒性较好。</li><li><strong>R² Score</strong>: 拟合优度，1表示完美，0表示和均值模型一样差。</li></ul><h2 id="_5-2-交叉验证-cross-validation-⭐⭐⭐⭐⭐" tabindex="-1">5.2 交叉验证 (Cross-Validation) ⭐⭐⭐⭐⭐ <a class="header-anchor" href="#_5-2-交叉验证-cross-validation-⭐⭐⭐⭐⭐" aria-label="Permalink to &quot;5.2 交叉验证 (Cross-Validation) ⭐⭐⭐⭐⭐&quot;">​</a></h2><p>为了更可靠地评估模型性能，避免一次划分的偶然性。</p><ul><li><strong>K-Fold</strong>: 将数据分成K份，轮流做验证集。</li><li><strong>Stratified K-Fold</strong>: 保持每折中类别比例一致（分类问题常用）。</li></ul><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sklearn.model_selection </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cross_val_score</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">scores </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cross_val_score(model, X, y, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">cv</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">scoring</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;accuracy&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;平均准确率:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, scores.mean())</span></span></code></pre></div><h2 id="_5-3-超参数调优" tabindex="-1">5.3 超参数调优 <a class="header-anchor" href="#_5-3-超参数调优" aria-label="Permalink to &quot;5.3 超参数调优&quot;">​</a></h2><h3 id="_5-3-1-网格搜索-grid-search" tabindex="-1">5.3.1 网格搜索 (Grid Search) <a class="header-anchor" href="#_5-3-1-网格搜索-grid-search" aria-label="Permalink to &quot;5.3.1 网格搜索 (Grid Search)&quot;">​</a></h3><p>穷举搜索所有参数组合。</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sklearn.model_selection </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> GridSearchCV</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">param_grid </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;n_estimators&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;max_depth&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">None</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">grid </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> GridSearchCV(RandomForestClassifier(), param_grid, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">cv</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">grid.fit(X_train, y_train)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;最佳参数:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, grid.best_params_)</span></span></code></pre></div><h3 id="_5-3-2-随机搜索-random-search" tabindex="-1">5.3.2 随机搜索 (Random Search) <a class="header-anchor" href="#_5-3-2-随机搜索-random-search" aria-label="Permalink to &quot;5.3.2 随机搜索 (Random Search)&quot;">​</a></h3><p>在参数空间随机采样，效率通常比网格搜索高。</p>`,17)])])}const c=i(l,[["render",h]]);export{E as __pageData,c as default};
